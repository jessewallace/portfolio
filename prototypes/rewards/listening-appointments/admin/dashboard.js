$(document).ready(function(){function e(e,t,s){var s="undefined"!=typeof s?s:"u-is-hidden";1==t?$(e).removeClass(s):$(e).addClass(s)}function t(){0===numberOfInstances&&(e("#emptyTable",!0),e("#sortable",!1))}function s(e,t){notifications.addClass(t).removeClass("u-is-hidden").html(e),setTimeout(function(){notifications.addClass("u-is-hidden").removeClass(t)},3e3)}function a(t,a,n,i){dialogChangeAnswer.dialog({autoOpen:!1,modal:!0,minWidth:500,resizable:!1,draggable:!1,open:function(e,s){$(this).parent().addClass("animated bounceInDown"),$(".ui-dialog-titlebar-close",s.dialog|s).hide(),"---"!==t?($(".js-answerInput").val(t),$(".js-matchInput").val(i)):($(".js-answerInput").val(""),$(".js-matchInput").val(""))},buttons:[{text:"Submit","class":"button-highlight",click:function(){$(this).dialog("close"),$(this).parent().removeClass("bounceInDown"),e(loader,!0),setTimeout(function(){e(loader,!1);var i=$(".js-answerInput").val();n.text(i),0!==i.length?(a.removeClass("is-incomplete"),i!==t?s("Your answer was successfully changed to </b>"+i+"</b>","success"):s("Your answer is still the same </b>"+i+"</b>","info")):(a.addClass("is-incomplete"),n.text("---"),s("Be sure to add an asnwer before the instance start date","warning"))},1e3)}},{text:"Cancel","class":"button",click:function(){$(this).dialog("close"),$(this).parent().removeClass("bounceInDown")}}]}),dialogChangeAnswer.dialog("open")}var n=$(".js-tableRow");instanceDetails=$(".js-tableDetails"),instanceID=$(".js-instanceID"),instanceFrequency=$("#instanceFrequency"),notifications=$(".js-statusMessage"),loader=$(".js-loader"),copyLink=$(".js-copyLink"),deactivateTrigger=$(".js-deactivate"),deleteTrigger=$(".js-delete"),numberOfInstances=n.length,groupView=$("#groupView"),snapShotView=$("#snapShot"),emptyView=$("#emptyView"),listItem=$(".js-listItem"),toggleAnswers=$(".js-toggleAnswers"),answerTables=$(".js-answerTable"),singleAnswerTable=$("#singleAnswer"),upcomingAnswers=$("#upcomingAnswers"),pastAnswers=$("#pastAnswers"),instanceTitle=$("#instanceTitle"),dialogChangeAnswer=$("#changeAnswer"),dialogDeactivate=$("#deactivateRecurring"),dialogCreateNew=$("#createNew"),changeAnswerTrigger=$(".js-changeAnswer"),createNewTrigger=$(".js-createNew"),listItem.on("click",function(){var t=$(this).data("title");days=$(this).data("days"),frequency=$(this).data("frequency"),type=$(this).data("type"),time=$(this).data("time"),date=$(this).data("start"),$(this).addClass("is-active").siblings().removeClass("is-active"),$("#instanceStart").text(date),$("#instanceTime").text(time+" EDT"),e(emptyView,!1),e(snapShotView,!0),"single"==type?(instanceTitle.html('<i class="fa fa-calendar-check-o"></i> '+t),e(singleAnswerTable,!0),e(upcomingAnswers,!1),e(instanceFrequency,!1),e("#multipleAnswers",!1),$("#deactivateButton").attr("data-deactivate","single")):(instanceTitle.html('<i class="fa fa-refresh"></i> '+t),e(instanceFrequency,!0),$("#instanceDays").text(frequency+": "+days),$("#deactivateButton").attr("data-deactivate","recurring"),e("#multipleAnswers",!0),$(this).hasClass("is-deactivated")?(e(singleAnswerTable,!1),e(".js-deactivateMessage",!0),e(upcomingAnswers,!1),e(pastAnswers,!0),e(toggleAnswers,!1),e("#deactivateButton, #editButton",!1),toggleAnswers.siblings().text("Past Answers"),$(".snapshot__actions").removeClass("button-group")):(e(".js-deactivateMessage",!1),e(singleAnswerTable,!1),e(pastAnswers,!1),e(upcomingAnswers,!0),e(toggleAnswers,!0),e("#deactivateButton, #editButton",!0),toggleAnswers.siblings().text("Upcoming Answers"),$(".snapshot__actions").addClass("button-group")))}),toggleAnswers.on("click",function(){pastAnswers.hasClass("u-is-hidden")?(e(pastAnswers,!0),e(upcomingAnswers,!1),$(this).text("View Upcoming Answers").siblings().text("Past Answers")):(e(pastAnswers,!1),e(upcomingAnswers,!0),$(this).text("View Past Answers").siblings().text("Upcoming Answers"))}),deactivateTrigger.on("click",function(){var t=$(this).data("deactivate"),a=($(this).closest(n).data("type"),$(".js-verifyCheck")),i=listItem.filter(".is-active");switch(t){case"recurring":dialogDeactivate.dialog({autoOpen:!1,modal:!0,minWidth:450,resizable:!1,draggable:!1,open:function(e,t){$(this).parent().addClass("animated bounceInDown"),$(".ui-dialog-titlebar-close",t.dialog|t).hide()},buttons:[{text:"Deactivate","class":"button-negative js-buttonDelete",click:function(){$(".js-verifyCheck:checked").length==$(".js-verifyCheck").length?(e(loader,!0),$(this).dialog("close"),$(this).parent().removeClass("bounceInDown"),setTimeout(function(){$(".js-errorMessage").addClass("u-is-hidden"),a.parent().removeClass("negative"),a.attr("checked",!1),i.removeClass("is-active").addClass("is-deactivated"),i.find(".days").remove(),e(emptyView,!0),e(snapShotView,!1),e(loader,!1),s("Instance were successfully deactivated!","success")},1e3)):($(".js-errorMessage").removeClass("u-is-hidden"),a.parent().addClass("negative"))}},{text:"Cancel","class":"button js-buttonDelete",click:function(){$(this).dialog("close"),$(this).parent().removeClass("bounceInDown"),$(".js-errorMessage").addClass("u-is-hidden"),a.parent().removeClass("negative"),a.attr("checked",!1)}}]}),dialogDeactivate.dialog("open");break;default:console.log("This type does not exist")}}),deleteTrigger.on("click",function(){var e=$(this).closest(n).data("number");$("#deleteSingle").dialog({autoOpen:!1,modal:!0,minWidth:425,resizable:!1,draggable:!1,open:function(e,t){$(this).parent().addClass("animated bounceInDown"),$(".ui-dialog-titlebar-close",t.dialog|t).hide()},buttons:[{text:"Delete","class":"button-negative",click:function(){$(this).dialog("close"),$(this).parent().removeClass("bounceInDown"),s("Instance(s) were deleted successfully!","success"),n.filter("[data-number="+e+"]").remove(),numberOfInstances--,t(),$("#sortable").empty,$(".js-emptyMessage").text("There are currently no listen and wins created")}},{text:"Cancel","class":"button",click:function(){$(this).dialog("close"),$(this).parent().removeClass("bounceInDown")}}]}),$("#deleteSingle").dialog("open")}),createNewTrigger.on("click",function(){dialogCreateNew.dialog({autoOpen:!1,modal:!0,minWidth:425,resizable:!1,draggable:!1,open:function(e,t){$(this).parent().addClass("animated bounceInDown"),$(".ui-dialog-titlebar-close",t.dialog|t).hide()},buttons:[{text:"Cancel","class":"button",click:function(){$(this).dialog("close"),$(this).parent().removeClass("bounceInDown")}}]}),dialogCreateNew.dialog("open")}),changeAnswerTrigger.on("click",function(){var e=$(this).data("answer"),t=$(this).closest(".dropdown").closest(".js-tableRow"),s=$(this).parent().closest("tr"),n=t.find(".js-instanceAnswer"),i=n.text(),o=t.data("match"),l=s.find("td:nth-child(2)"),c=s.find("td:nth-child(3)"),r=l.text(),d=c.text();switch(e){case"schedule":a(i,t,n,o);break;default:a(r,s,l,d)}}),copyLink.on("click",function(){s("Copied Successfully!","success")}),$(".js-showSchedule").on("click",function(){e(groupView,!1),e("#scheduleView",!0),e(".js-showScheduleDate",!0,"u-is-visually-hidden")}),$(".js-showGroup").on("click",function(){e(groupView,!0),e("#scheduleView",!1),e(".js-showScheduleDate",!1,"u-is-visually-hidden")}),$(".js-answerInput").on("blur",function(){var e=$(this).val(),t=$(".js-matchInput"),s=e.substring(0,3).toLowerCase();e.length>0&&""===t.val()&&$(".js-matchInput").val(s)}),$(".filter-survey").on("click",function(e){$(".filters").toggle(),$(this).find("i").toggleClass("fa-caret-down fa-caret-up"),e.preventDefault()})});