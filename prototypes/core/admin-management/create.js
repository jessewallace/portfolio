$(document).ready(function(){function e(e,s){var i='<li class="js-createdAdmin list__item list__item--inline animated highlight" data-name="'+s+'">'+e+"</li>";return i}function s(){$createPermissionDiaglog.dialog({autoOpen:!0,modal:!0,width:500,resizable:!1,draggable:!1,buttons:[{text:"Create",class:"button-positive",click:function(){$(this).dialog("close"),r(this),a($emptyPermissions,!1),a($permissionGroups,!0,"u-is-visually-hidden"),$permissionGroups.addClass("has-permission"),a($superAdminRoles,!1),$userRoles.removeClass("u-is-visually-hidden")}},{text:"Cancel",click:function(){$(this).dialog("close"),r(this)}}],open:function(e,s){$(this).parent().addClass("animated bounceInDown"),$(this).closest(".ui-dialog").find(".ui-dialog-titlebar-close").hide(),$dynamicChosen.val("").trigger("chosen:updated"),$dynamicChosen.trigger("chosen:close"),$("#selectedOrgs").addClass("is-hidden").html(""),$("#emptyStateOrgs").removeClass("is-hidden"),$dynamicChosen.chosen({placeholder_text_multiple:"Start typing to select a tag or single org"})}})}function i(e,s){$(e).css({"-webkit-transform":"translateX(-"+s+"%)","-moz-transform":"translateX(-"+s+"%)",transform:"translateX(-"+s+"%)"})}function a(e,s,i){var i="undefined"!=typeof i?i:"is-hidden";1==s?$(e).removeClass(i):$(e).addClass(i)}function t(e){1!=e||$permissionGroups.hasClass("has-permission")||3!=c.val()&&5!=c.val()&&6!=c.val()||s()}function n(e){e>0?a(shiftButtonPrev,!0):a(shiftButtonPrev,!1)}function o(e){1==e?(a(shiftButtonNext,!1),a(shiftButtonSave,!0)):(a(shiftButtonNext,!0),a(shiftButtonSave,!1))}function l(e,s){return shiftAmount=1/e*100,shiftAmount*s}function r(e){$(e).parent().removeClass("animated bounceInDown")}function d(e,s){var i='<div class="js-listItem module list__block list__block--b width-1-1 u-display-flex u-display-flex--vcentered animated highlight"><span class="list__block-icon fa fa-times"></span><div class="js-groupTag u-display-flex u-display-flex--vcentered width-1-1"><div class="stack stack--alternate"><b class="stack__header">'+e+'</b><span class="stack__meta">'+s+'</span></div><span class="u-flex-right pill pill--format u-mr15">Format</span><i class="fa fa-chevron-right"></i></div></div>';return i}var c=$(".js-chosenAdmin");$adminOwner=$(".js-chosenOwner"),breadcrumbs=$("#breadCrumbs"),breadcrumb=$(".js-breadcrumb"),breadcrumbNumber=breadcrumbs.find(breadcrumb).length,breadcrumbActive=breadcrumb.children().filter(".is-active"),breadcrumbDisabled=breadcrumb.children().filter(".is-disabled"),breadcrumbModule=breadcrumb.index(1),$cancelWork=$(".js-cancel"),$cancelWorkDialog=$("#cancelWorkDialog"),$changeAccountType=$("#changeAccount"),$cardOrgManagement=$("#card4"),$chosen=$(".js-chosen"),$chosenRequired=$(".js-chosen--required"),$chosenAdmin=$(".js-chosenAdmin"),$chosenRoles=$(".js-chosen--roles"),$createPermissionDiaglog=$("#createPermission"),$createdAdmins=$("#createdAdmins"),$createdAdminsList=$("#createdAdminList"),$deletePermission=$(".js-deletePermission"),$deletePermissionDialog=$("#deleteGroupDialog"),$dynamicChosen=$(".js-chosen-dynamic"),$emptyPermissions=$("#emptyPermissionGroups"),$multipleUser=$("#multipleUser"),$perfectScroll=$(".js-perfectScroll"),$permissionGroups=$("#permissionGroups"),$numberOfadminsCreated=0,$roleSelectionHeader=$("#roleSelectionHeader"),shiftButton=$(".js-buttonShift"),shiftButtonNext=shiftButton.filter('[data-button="Next"]'),shiftButtonPrev=shiftButton.filter('[data-button="Previous"]'),shiftButtonSave=shiftButton.filter('[data-button="Save"]'),$showMoreEmails=$(".js-showMore"),$singleUserInfo=$("#singleUserInfo"),$singleUser=$("#singleUser"),sliderContainer=$("#slider"),subSections=$(".js-sliderSection"),$superAdminPermission=$("#superAdminPermissionGroups"),$superAdminRoles=$("#superAdminRoles"),$tagitEmail=$(".js-tagit-email"),$tagitLabel=$(".tagit-label"),$tagCreationPanel=$("#sliderTagsCreator"),$tagSites=$("#sliderTagSites"),$userRoles=$("#roles"),$viewOrgs=$(".js-viewOrgs");var u=0,m=0;breadcrumb.on("click",function(){var e=$(this).index();c.val()&&$adminOwner.val()&&$tagitEmail.val()&&(sliderContainer.children().removeClass("is-active"),sliderContainer.children().eq(e).addClass("is-active"),n(e),t(e),o(e),i(sliderContainer,l(2,e)),$(this).find(".breadcrumb__link").addClass("is-active"),$(this).siblings().find(".breadcrumb__link.is-active").removeClass("is-active")),console.log(e)}),$(".js-buttonShift").on("click",function(){var e=$(this).data("button"),s=($(".js-sliderSection.is-active").index(),50);c.val()&&$adminOwner.val()&&$tagitEmail.val()&&("Next"==e?u<2&&(subSections.removeClass("is-active"),subSections=subSections.next(),subSections.addClass("is-active"),u++,m+=s,i(sliderContainer,m)):"Save"==e?$("#loadingIndicator").removeClass("is-hidden"):(subSections.removeClass("is-active"),subSections=subSections.prev(),subSections.addClass("is-active"),u--,m-=s,i(sliderContainer,m)),$(".breadcrumb__link").removeClass("is-active"),breadcrumb.eq(u).find(".breadcrumb__link").addClass("is-active"),n(u),t(u),o(u)),console.log(u)}),$chosen.chosen({disable_search_threshold:10}),$chosenAdmin.change(function(){if(c.val()&&$emptyPermissions.hasClass("is-hidden")&&$chosenRoles.val()){var e=c.val();console.log(e),$changeAccountType.dialog({autoOpen:!0,modal:!0,width:400,resizable:!1,draggable:!1,buttons:[{text:"Yes, Change Account",class:"button-negative",click:function(){$(this).dialog("close"),r(this),1==c.val()||2==c.val()||4==c.val()?a($emptyPermissions,!1):a($emptyPermissions,!0),$chosenRoles.val("").trigger("chosen:updated"),a($permissionGroups,!1),$permissionGroups.removeClass("has-permission"),a($superAdminRoles,!1),$userRoles.addClass("u-is-visually-hidden")}},{text:"No, Go Back",click:function(){$(this).dialog("close"),r(this)}}],open:function(e,s){$(this).parent().addClass("animated bounceInDown"),$(this).closest(".ui-dialog").find(".ui-dialog-titlebar-close").hide()}})}}),$chosenRequired.change(function(){var e=$(".js-chosenOwner option:selected").text();c.val()&&$adminOwner.val()&&$tagitEmail.val()?(breadcrumbDisabled.removeClass("is-disabled").attr("title",""),shiftButtonNext.attr("disabled",!1)):(breadcrumbDisabled.addClass("is-disabled").attr("title","You must add an email and select an admin type and owner before proceeding"),shiftButtonNext.attr("disabled",!0)),1==c.val()||2==c.val()||4==c.val()?($roleSelectionHeader.text(e),$permissionGroups.addClass("has-permission").removeClass("u-is-visually-hidden"),$(".js-editOrgGroup, .js-createGroup").addClass("is-hidden")):($roleSelectionHeader.text("Atlanta, CBSCHI - CBS Chicago"),$permissionGroups.removeClass("has-permission"),$(".js-editOrgGroup, .js-createGroup").removeClass("is-hidden")),1==c.val()||2==c.val()||3==c.val()?a($cardOrgManagement,!0):a($cardOrgManagement,!1),$chosenRequired.trigger("chosen:updated")}),$chosenRoles.change(function(){$chosenRoles.val()&&$permissionGroups.hasClass("has-permission")?shiftButtonSave.attr("disabled",!1):shiftButtonSave.attr("disabled",!0),$chosenRoles.trigger("chosen:updated")}),$dynamicChosen.change(function(e,s){var i=s.selected,a=$(".js-chosen-dynamic option:selected").text();console.log(i,a),$("#selectedOrgs").prepend(d(a,i)).removeClass("is-hidden"),$("#emptyStateOrgs").addClass("is-hidden")}),c.change(function(e,s){var i=s.selected;1==i||2==i||4==i?(a($superAdminPermission,!0),$userRoles.removeClass("u-is-visually-hidden"),a($emptyPermissions,!1),a($permissionGroups,!0),a($superAdminRoles,!1)):(a($superAdminPermission,!1),a($superAdminRoles,!0),$userRoles.addClass("u-is-visually-hidden"),a($emptyPermissions,!0)),1==i||2==i||3==i?($adminOwner.val(211).trigger("change").attr("disabled",!0),$adminOwner.trigger("chosen:updated")):211!=$adminOwner.val()?$adminOwner.trigger("chosen:updated"):($adminOwner.val("").trigger("change").attr("disabled",!1),$adminOwner.trigger("chosen:updated"))}),$("#singleUser:checked")&&(tagValue=$tagitEmail.val(),$tagitEmail.on("blur",function(){a($createdAdmins,!0),$createdAdminsList.find(".js-showMore").prevAll().remove(),$showMoreEmails.before(e($(this).val(),1))})),$(".js-radioBtn").on("click",function(){$tagitEmail.val()&&($createdAdminsList.find(".js-showMore").prevAll().remove(),$tagitEmail.val(""),a($createdAdmins,!1)),$("#singleUser:checked").length>0?(a($singleUserInfo,!0),$tagitEmail.tagit("destroy")):(a($singleUserInfo,!1),$tagitEmail.tagit({afterTagAdded:function(s,i){var t=i.tag.find(".tagit-label").text();$tagitLabel.each(function(){$(this).attr("id",$(this).text())}),$numberOfadminsCreated++,$numberOfadminsCreated>6&&a($showMoreEmails,!0),a($createdAdmins,!0),$showMoreEmails.before(e(t,t))},afterTagRemoved:function(e,s){var i=s.tag.find(".tagit-label").text(),t=$('.list__item--inline[data-name="'+i+'"]');$numberOfadminsCreated--,$numberOfadminsCreated<=6&&a($showMoreEmails,!1),t.remove()}}))}),$showMoreEmails.click(function(){"Show Less"==$(this).html()?$(this).html("Show More"):$(this).html("Show Less"),$createdAdminsList.toggleClass("has-overflow")}),$perfectScroll.perfectScrollbar(),$(".js-createGroup").on("click",function(){s()}),$cancelWork.on("click",function(){var e=$(this).data("cancel");c.val()||$adminOwner.val()||$tagitEmail.val()?$cancelWorkDialog.dialog({autoOpen:!0,modal:!0,width:350,resizable:!1,draggable:!1,buttons:[{text:"Yes, Discard Changes",class:"button-negative",click:function(){$(this).dialog("close"),r(this),location.href=e}},{text:"No, Go Back",click:function(){$(this).dialog("close"),r(this)}}],open:function(e,s){$(this).parent().addClass("animated bounceInDown"),$(this).closest(".ui-dialog").find(".ui-dialog-titlebar-close").hide()}}):location.href=e}),$deletePermission.on("click",function(){var e=$(this).closest(".card");$deletePermissionDialog.dialog({autoOpen:!0,modal:!0,width:350,resizable:!1,draggable:!1,buttons:[{text:"Yes, Delete Group",class:"button-negative",click:function(){$(this).dialog("close"),e.remove(),a($emptyPermissions,!0),a($permissionGroups,!1),$permissionGroups.removeClass("has-permission"),a($superAdminRoles,!0),$userRoles.addClass("u-is-visually-hidden")}},{text:"No, Go Back",click:function(){$(this).dialog("close"),r(this)}}],open:function(e,s){$(this).parent().addClass("animated bounceInDown"),$(this).closest(".ui-dialog").find(".ui-dialog-titlebar-close").hide()}})}),$viewOrgs.on("click",function(){'<i class="fa fa-chevron-circle-left"></i> Go Back'==$(this).html()?$(this).html('<i class="fa fa-eye"></i> View Org(s)'):$(this).html('<i class="fa fa-chevron-circle-left"></i> Go Back'),$(".card__flipper").toggleClass("is-flipped")}),$("body").on("click",".js-groupTag",function(){$tagCreationPanel.removeClass("is-active"),$tagSites.addClass("is-active"),i($("#sliderTags"),50)}),$(".js-goBack").on("click",function(){$tagCreationPanel.addClass("is-active"),$tagSites.removeClass("is-active"),i($("#sliderTags"),0)})});